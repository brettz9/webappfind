## User guide (for end-users)

(For command line usage, see the API below instead.)

It is hoped that the instructions below can be further simplified
once the Executable Builder component is enhanced to automatically
associate default file types to (web) applications (and optionally
add them to the Dock, etc.) without the user needing to find the
path of these executables as WebAppFind currently requires.

### Usage of the executables on your OS desktop

Note that you must first install the WebExtensions add-on so that
the following steps will work (the add-on has not yet been submitted
to the Add-ons site, so for now, you will have to build the add-on
from source).

1. Right-click on a file and...
    1. If you want to use WebAppFind without disturbing your defaults
        for that file extension, select "Open With"->"Other..." and
        if you want to always open that particular file with WebAppFind,
        you can also check "Always Open With". (Alternatively, you can
        select "Get Info" (`command-I`) and change the value in the
        "Open with" pull-down and then the file can just be double-clicked
        in the future.)
        <!--
        Note: on Windows, when available again, the following instructions can be used:

        select "Open with"->"Choose default program..." if present (or if
        not present, open the file and choose "Select a program
        from a list of installed programs") and then make sure "Always use
        the selected program to open this kind of file" is not checked.
        -->
    1. If you always want to use WebAppFind when handling files with the same
        extension as this file (and just be able to double-click such files
        when opening them in the future), you can select "Get Info"
        (`command-I`) and change the value in the "Open with" pull-down and
        then click "Change All.." to apply to all such files of that file
        extension.
        <!--
        TODO: on Windows, when available again, the following instructions can be used:

        click "Properties", then click "Change..." next to
        "Opens with:" in the General tab of the dialog.
        -->
<!--
TODO: on Windows, when available again, the following instructions can be used:
1. Click "Browse".
-->
1. Navigate to an executable built following the instructions in the section
    "Executable builder functionality" (Or, if
    you prefer, you can use one of the pre-built binaries includes in the `bin`
    folder of this repository, though see the above-mentioned section anyways
    on the differences of functionality in those binaries).
1. Select "Ok".
1. If you used "Open with" (as per step 1.1 above), your file should have
    already opened with WebAppFind. If you opted for "Get Info" in step 1
    <!-- TODO: On Windows, once implemented "Properties" -->
    you should now be able to double-click the file (or any file possessing
    the same extension if you followed step 1.2) to open it with WebAppFind.

If an edit `web+local` protocol is enabled and open and then disabled in
the same session, it will keep having save access (though within that
window session only). One must currently close any open tabs for that
web application if one no longer wishes to allow access (though as noted
elsewhere in this documentation, the app only has access to the files to
which you granted access).

## Executable builder (building executables for use on OS desktop)

An AppleScript file can be generated by invoking the `native-app.js`
application (and executable?) with the arguments below which will allow
one to pass predetermined or run-time parameters through WebAppFind, along
with a local file opened by "open with", as a default file association, via
drag-and-drop (including if placed conveniently on one's dock), command
line, or a file optionally baked into the script. In place of a local file,
if the generated AppleScript is called with no arguments (including when
placed on the dock), a file selector will pop-up to determine the file
whose contents will be sent to your web applications.

If the AppleScript is invoked on the command line, one can invoke with:

<!--
```bash
open ./webappfind-as.app --args /Users/brett/myFile.txt
```
-->
```bash
osascript ./webappfind-as.app /Users/brett/myFile.txt
```

or to bring up the file selector, just:
<!--
```bash
open ./webappfind-as.app
```
-->
```basePath
osascript ./webappfind-as.app
```

You can then follow the instructions in "Usage notes (for end-users)"
to use "Open with" or to associate a specific file or all files of a
certain extension with the web app that will be chosen as a result of
running this executable.

Alternatively or in addition, you can drag this file to your Dock,
Favorites, etc. so as to be able to drag files onto it for opening
(or to just click it to open any hard-baked file or to get the file
dialog otherwise).

### Arguments

- **method** - Required. Must be set to "build-openwith-exec".
- **id** - Value for `CFBundleIdentifier`, uniquely identifying app to the OS.
- **file** - Optional hard-baking of a file. If this argument is not included,
    the generated script will check for the presence of an argument to the
    script to serve as the file to pass to the web application. If no argument
    is passed to the *generated script*, its absence will trigger a file
    dialog.
- **mode** - Optional mode for invoking the web app on your contents, either
    "view" (readonly) or "edit" (read and write). Default is "view".
    If this is for a program needing to open a file in binary mode, such as
    images, sound files, or videos, use "binaryview" or "binaryedit" instead.
    The `filetypes.json` file can be used to force "binary" or not for
    the respective view or edit mode.
- **site** - Optional baking in of a specific site to invoke with the
    designated file's contents. Will check for local `filetypes.json`
    otherwise.
- **args** - Optional. Any arguments to pass to the web applications
    `onmessage` listener data object (under `args`).
- **fileSelectMessage** - When the generated script does not have a baked-in
    file and no file argument is passed to it, this argument will determine
    the message shown in the resulting file dialog.
- **fileSelectType** - When the generated script does not have a baked-in file
    and no file argument is passed to it, this argument, if present, will have
    the script insist on a particular file type in the resulting file dialog.
    Must be an extension string without the leading period (e.g., "js" for
    ".js" JavaScript files) or a
    [Uniform Type Identifier](https://en.wikipedia.org/wiki/Uniform_Type_Identifier),
    e.g., "public.image" or "com.apple.iwork.pages.sffpages".

## Command line communication with add-on

In order to pass a file into the add-on (which can use any arguments and its
heuristics to determine the specific website to open and in what manner),
the `native-app.js` file should be invoked with `--method=client` and
optionally with
`--file="..."`, `--mode="view|edit"`, `--site="http://..."`, `--args="..."`.
See "Executable builder functionality" "Arguments" section for how these
optional methods will be used.

## `filetypes.json`

For an explanation of the `filetypes.json` format (e.g., if you wish to tweak
it as a user), see the [Developer-Guide](./Developer-Guide.md).

## Tools and Comparisons

For tips for using with other tools and comparison to other similar tools,
see [Tools-and-Comparisons](./Tools-and-Comparisons.md)

## Executable Builder

See [executable-builder/README.md](../executable-builder/README.md)
